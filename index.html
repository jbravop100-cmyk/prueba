<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analista de Ciberseguridad & ML - Portfolio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <!-- Iconos de Lucide -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        :root {
            --color-primary: #66fcf1; /* Cian Neón */
            --color-secondary: #45a29e; /* Azul verdoso */
            --color-dark: #1f2833; /* Azul Oscuro/Carbón */
            --color-background: #0b0c10; /* Casi Negro */
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--color-background);
        }
        .text-neon { color: var(--color-primary); }
        .bg-dark { background-color: var(--color-dark); }
        .border-neon { border-color: var(--color-primary); }
        .shadow-neon { box-shadow: 0 0 15px rgba(102, 252, 241, 0.4); }

        .project-card {
            transition: transform 0.3s, box-shadow 0.3s;
        }
        .project-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 10px 20px rgba(102, 252, 241, 0.3);
            border-color: var(--color-primary);
        }
        
        /* Estilos para los Logs/Vectores */
        .vector-box {
            background-color: #1a232b;
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid #3a4a58;
            cursor: pointer;
            word-break: break-all;
            position: relative;
            transition: background-color 0.2s, box-shadow 0.1s;
        }
        .vector-box:hover {
            background-color: #24303d;
        }
        #log-panel {
            max-height: 400px;
            overflow-y: scroll;
            padding: 1rem;
            border: 1px solid #3a4a58;
            border-radius: 8px;
            background-color: #1a232b;
        }
        /* Scrollbar estilo neón */
        #log-panel::-webkit-scrollbar {
            width: 8px;
        }
        #log-panel::-webkit-scrollbar-thumb {
            background-color: var(--color-secondary);
            border-radius: 4px;
        }
        #log-panel::-webkit-scrollbar-track {
            background: var(--color-dark);
        }
    </style>
</head>
<body class="text-gray-300">

    <!-- Navbar -->
    <nav class="sticky top-0 z-50 bg-dark/95 backdrop-blur-sm p-4 border-b border-gray-700/50">
        <div class="max-w-6xl mx-auto flex justify-between items-center">
            <a href="#inicio" class="text-xl font-extrabold tracking-widest text-neon">
                &lt;TuNombre /&gt;
            </a>
            <div class="space-x-4 flex">
                <a href="#proyectos" class="hover:text-neon transition">Proyectos</a>
                <a href="#habilidades" class="hover:text-neon transition">Habilidades</a>
                <a href="#logs" class="hover:text-neon transition">Logs (Honeypot)</a> 
                <a href="#contacto" class="hover:text-neon transition">Contacto</a>
            </div>
        </div>
    </nav>

    <!-- Sección de Inicio (Hero) -->
    <header id="inicio" class="pt-24 pb-32 bg-dark flex items-center justify-center">
        <div class="max-w-6xl mx-auto px-6 text-center">
            <div class="w-24 h-24 rounded-full mx-auto mb-6 border-2 border-neon flex items-center justify-center bg-gray-800">
                <i data-lucide="shield-check" class="w-12 h-12 text-neon"></i>
            </div>
            <h1 class="text-5xl md:text-7xl font-extrabold tracking-tight mb-4 text-white">
                Analista de <span class="text-neon shadow-neon/50">Ciberseguridad</span>
            </h1>
            <h2 class="text-2xl text-gray-400 mb-8">
                Especialista en Machine Learning para Detección de Amenazas.
            </h2>
            <div class="flex justify-center space-x-4">
                <a href="#proyectos" class="px-6 py-3 bg-neon font-bold text-dark rounded-lg transition hover:shadow-neon">
                    Ver Proyectos
                </a>
                <a href="#contacto" class="px-6 py-3 border border-neon text-neon font-bold rounded-lg transition hover:bg-neon hover:text-dark">
                    Contactar
                </a>
            </div>
        </div>
    </header>
    
    <!-- Sección de Logs (Honeypot) -->
    <section id="logs" class="py-20 bg-background px-6 border-t border-gray-800">
        <div class="max-w-6xl mx-auto">
            <h3 class="text-4xl font-bold text-center mb-12 text-white">
                <span class="text-neon">//</span> Logs de Tráfico (Honeypot de Bajo Nivel)
            </h3>
            <p class="text-center text-gray-400 mb-8">
                Monitorea en tiempo real los metadatos de los visitantes de esta página.
            </p>

            <div class="flex justify-center mb-6">
                <p id="auth-status" class="text-sm px-4 py-2 rounded-full bg-dark border border-gray-700"></p>
            </div>

            <div id="log-panel" class="space-y-4">
                <p class="text-gray-500 text-center">Cargando datos de visitantes...</p>
            </div>
        </div>
    </section>

    <!-- Sección de Proyectos -->
    <section id="proyectos" class="py-20 bg-background px-6 border-t border-gray-800">
        <div class="max-w-6xl mx-auto">
            <h3 class="text-4xl font-bold text-center mb-12 text-white">
                <span class="text-neon">//</span> Proyectos Destacados
            </h3>

            <div class="grid md:grid-cols-2 gap-10">
                
                <!-- Proyecto 1: IDS (IDS Sentinel ML) -->
                <div class="project-card p-8 rounded-xl bg-dark border-4 border-neon shadow-2xl shadow-neon/20 col-span-2">
                    <div class="flex items-center mb-4">
                        <i data-lucide="shield-alert" class="w-8 h-8 text-red-500 mr-4"></i>
                        <h4 class="text-3xl font-bold text-white">IDS - Sentinel ML</h4>
                    </div>
                    <p class="text-gray-400 mb-4">
                        **Solución de Detección de Intrusos (IDS) de próxima generación** que utiliza Machine Learning avanzado para identificar y clasificar ataques de red en tiempo real.
                    </p>
                    <ul class="list-disc list-inside text-gray-400 text-sm space-y-2 mb-6 ml-4">
                        <li>Modelo **Random Forest** entrenado con 78 características para máxima precisión.</li>
                        <li>Implementación de **PCA** para optimizar el rendimiento y la velocidad de clasificación.</li>
                        <li>**Análisis de Incertidumbre:** Detecta anomalías con baja confianza (por debajo del 70%) en el tráfico benigno.</li>
                    </ul>
                    
                    <h5 class="text-xl font-bold text-neon mb-4 border-t pt-4 border-gray-700">Vectores de Prueba para Demo</h5>
                    <p class="text-sm text-gray-400 mb-4">Haz clic en cualquier vector para copiarlo y demostrar la capacidad del modelo.</p>
                    
                    <!-- Vectores -->
                    <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                        <!-- Vector BENIGNO -->
                        <div class="vector-box group" data-vector="0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0" onclick="copyVector(this)">
                            <p class="text-xs font-bold text-neon">Tráfico Normal (Benigno)</p>
                            <p class="text-xs text-gray-300 truncate mt-1">
                                0.0, 0.0, 0.0, ... (78 ceros)
                            </p>
                            <span class="absolute top-1 right-1 text-xs text-gray-500 group-hover:text-neon transition">Copiar</span>
                        </div>
                        
                        <!-- Vector ATAQUE (Por ejemplo, DDoS) -->
                        <div class="vector-box group" data-vector="0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0" onclick="copyVector(this)">
                            <p class="text-xs font-bold text-red-500">Ataque DDoS</p>
                            <p class="text-xs text-gray-300 truncate mt-1">
                                0.0, 0.0, 0.0, ..., 1.0 (Ejemplo de DDoS)
                            </p>
                            <span class="absolute top-1 right-1 text-xs text-gray-500 group-hover:text-neon transition">Copiar</span>
                        </div>
                        
                        <!-- Vector ANOMALÍA (Baja Confianza) -->
                        <div class="vector-box group" data-vector="0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5" onclick="copyVector(this)">
                            <p class="text-xs font-bold text-yellow-500">Anomalía (Baja Confianza)</p>
                            <p class="text-xs text-gray-300 truncate mt-1">
                                0.0, 0.0, 0.0, ..., 0.5 (Tráfico Mixto)
                            </p>
                            <span class="absolute top-1 right-1 text-xs text-gray-500 group-hover:text-neon transition">Copiar</span>
                        </div>
                    </div>

                    <a href="#" target="_blank" class="text-neon font-bold flex items-center mt-6 hover:underline">
                        Ver Repositorio de Código <i data-lucide="external-link" class="w-4 h-4 ml-2"></i>
                    </a>
                </div>

                <!-- Proyecto 2: Clasificación de Malware (Placeholder) -->
                <div class="project-card p-6 rounded-xl bg-dark border border-gray-700/50">
                    <div class="flex items-center mb-4">
                        <i data-lucide="code-square" class="w-6 h-6 text-yellow-500 mr-3"></i>
                        <h4 class="text-2xl font-semibold text-white">Análisis Estático de Malware</h4>
                    </div>
                    <p class="text-gray-400 mb-4">
                        Implementación de un clasificador binario para identificar familias de malware a partir de la estructura de archivos ejecutables (PE), sin necesidad de ejecutar el código.
                    </p>
                    <p class="text-sm font-medium text-neon mb-4">
                        Tecnologías: Python, TensorFlow, Keras, Análisis de Cabeceras PE.
                    </p>
                    <a href="#" target="_blank" class="text-neon font-bold flex items-center hover:underline">
                        Ver Código <i data-lucide="external-link" class="w-4 h-4 ml-2"></i>
                    </a>
                </div>
                
            </div>
        </div>
    </section>
    
    <!-- Sección de Habilidades (Skills) -->
    <section id="habilidades" class="py-20 bg-dark px-6 border-t border-gray-800">
        <div class="max-w-6xl mx-auto">
            <h3 class="text-4xl font-bold text-center mb-12 text-white">
                <span class="text-neon">//</span> Habilidades Técnicas
            </h3>
            
            <div class="grid grid-cols-2 md:grid-cols-4 gap-8 text-center">
                <!-- Habilidad 1: Python -->
                <div class="p-4 rounded-lg bg-gray-800 hover:bg-gray-700 transition">
                    <i data-lucide="code" class="w-8 h-8 text-neon mx-auto mb-2"></i>
                    <p class="font-semibold text-white">Python</p>
                    <p class="text-xs text-gray-400">ML, Scripting, Automation</p>
                </div>
                <!-- Habilidad 2: Redes -->
                <div class="p-4 rounded-lg bg-gray-800 hover:bg-gray-700 transition">
                    <i data-lucide="network" class="w-8 h-8 text-neon mx-auto mb-2"></i>
                    <p class="font-semibold text-white">Redes & TCP/IP</p>
                    <p class="text-xs text-gray-400">Análisis de Tráfico (Wireshark)</p>
                </div>
                <!-- Habilidad 3: Machine Learning -->
                <div class="p-4 rounded-lg bg-gray-800 hover:bg-gray-700 transition">
                    <i data-lucide="brain" class="w-8 h-8 text-neon mx-auto mb-2"></i>
                    <p class="font-semibold text-white">Machine Learning</p>
                    <p class="text-xs text-gray-400">Random Forest, PCA, Regresión</p>
                </div>
                <!-- Habilidad 4: SO (Linux) -->
                <div class="p-4 rounded-lg bg-gray-800 hover:bg-gray-700 transition">
                    <i data-lucide="server" class="w-8 h-8 text-neon mx-auto mb-2"></i>
                    <p class="font-semibold text-white">Sistemas Operativos</p>
                    <p class="text-xs text-gray-400">Linux, Bash/Shell Scripting</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Sección de Contacto -->
    <section id="contacto" class="py-20 bg-background px-6 border-t border-gray-800">
        <div class="max-w-xl mx-auto text-center">
            <h3 class="text-4xl font-bold mb-4 text-white">
                ¿Interesado en Colaborar?
            </h3>
            <p class="text-gray-400 mb-8">
                Mi bandeja de entrada está siempre abierta para oportunidades de trabajo, proyectos de ciberseguridad o colaboración en investigación.
            </p>

            <form onsubmit="event.preventDefault(); alert('Mensaje simulado enviado.');" class="space-y-4">
                <input type="text" placeholder="Tu Nombre" class="w-full p-3 rounded-lg bg-dark border border-gray-700 focus:border-neon focus:ring-neon text-white" required>
                <input type="email" placeholder="Tu Correo Electrónico" class="w-full p-3 rounded-lg bg-dark border border-gray-700 focus:border-neon focus:ring-neon text-white" required>
                <textarea rows="4" placeholder="Tu Mensaje..." class="w-full p-3 rounded-lg bg-dark border border-gray-700 focus:border-neon focus:ring-neon text-white" required></textarea>
                <button type="submit" class="w-full px-6 py-3 bg-neon font-bold text-dark rounded-lg transition hover:shadow-neon">
                    Enviar Mensaje
                </button>
            </form>

            <div class="flex justify-center space-x-6 mt-10">
                <a href="https://linkedin.com/in/tunombre" target="_blank" class="text-gray-400 hover:text-neon transition">
                    <i data-lucide="linkedin" class="w-6 h-6"></i>
                </a>
                <a href="https://github.com/tuusuario" target="_blank" class="text-gray-400 hover:text-neon transition">
                    <i data-lucide="github" class="w-6 h-6"></i>
                </a>
                <a href="mailto:tu.correo@ejemplo.com" class="text-gray-400 hover:text-neon transition">
                    <i data-lucide="mail" class="w-6 h-6"></i>
                </a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="p-6 bg-dark/50 border-t border-gray-700/50 text-center text-sm text-gray-500">
        <p>&copy; 2024 Tu Nombre. Desarrollado con Tailwind CSS y Neon Vibes.</p>
    </footer>

    <!-- Script de Copia de Vector y Firebase/Firestore para Logs (CRÍTICO) -->
    <script type="module">
        // Importaciones de Firebase (necesarias para la base de datos y la autenticación)
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInWithCustomToken, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, onSnapshot, query, limit } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Inicializar Lucide Icons
        lucide.createIcons();
        
        // logs de depuración para Firestore
        setLogLevel('Debug');

        // Referencias a los elementos de la interfaz
        const logPanel = document.getElementById('log-panel');
        const authStatusElement = document.getElementById('auth-status');
        
        let db = null;
        let auth = null;
        let userId = null;

        // --- FUNCIONES DE BASE DE DATOS Y AUTENTICACIÓN ---

        /**
         * Inicializa Firebase, autentica y registra el log del visitante.
         */
        async function initFirebaseAndLogVisitor() {
            try {
                // 1. Configuración y App ID (MANDATORY)
                const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
                const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
                const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
                
                if (Object.keys(firebaseConfig).length === 0 || !firebaseConfig.projectId) {
                    console.error("La configuración de Firebase no está disponible.");
                    authStatusElement.innerHTML = `<i data-lucide="alert-triangle" class="w-4 h-4 inline mr-1 text-yellow-500"></i> No conectado a DB.`;
                    logPanel.innerHTML = `<p class="text-yellow-500 text-center">Modo local: No se pueden guardar logs de visitantes sin Firebase Config.</p>`;
                    lucide.createIcons();
                    return; 
                }

                // 2. Inicializar la App y los Servicios
                const app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                auth = getAuth(app);

                // 3. Autenticación (usando el token inicial o de forma anónima)
                if (initialAuthToken) {
                    await signInWithCustomToken(auth, initialAuthToken);
                    userId = auth.currentUser.uid;
                    authStatusElement.innerHTML = `<i data-lucide="user-check" class="w-4 h-4 inline mr-1 text-neon"></i> Usuario: <span class="text-white">${userId}</span>`;
                } else {
                    await signInAnonymously(auth);
                    userId = auth.currentUser.uid;
                    authStatusElement.innerHTML = `<i data-lucide="user-plus" class="w-4 h-4 inline mr-1 text-yellow-500"></i> Usuario Anónimo: <span class="text-white">${userId}</span>`;
                }
                
                lucide.createIcons(); 

                // 4. Registrar la visita y escuchar los logs
                await logVisitor();
                setupLogsListener(appId, userId);

            } catch (error) {
                console.error("Error al inicializar Firebase o al autenticar:", error);
                authStatusElement.innerHTML = `<i data-lucide="alert-octagon" class="w-4 h-4 inline mr-1 text-red-500"></i> Error al cargar logs.`;
                logPanel.innerHTML = `<p class="text-red-500 text-center">No se pudieron cargar los logs: ${error.message}</p>`;
                lucide.createIcons();
            }
        }

        /**
         * Obtiene la IP (simulada o real) y registra los metadatos del visitante en Firestore.
         */
        async function logVisitor() {
            if (!db || !userId) return;

            let publicIP = 'Simulada';
            try {
                // Intenta obtener la IP pública de un servicio externo (con manejo de reintentos)
                const response = await fetchWithRetry('https://api.ipify.org?format=json', 3);
                if (response && response.ok) {
                    const ipData = await response.json();
                    publicIP = ipData.ip || 'Simulada';
                }
            } catch (error) {
                console.warn("No se pudo obtener la IP pública. Usando IP local simulada.", error);
                publicIP = '192.168.' + Math.floor(Math.random() * 255) + '.' + Math.floor(Math.random() * 255);
            }

            const logData = {
                timestamp: new Date().toISOString(),
                userAgent: navigator.userAgent,
                referrer: document.referrer || 'Directo',
                screenResolution: `${window.screen.width}x${window.screen.height}`,
                publicIP: publicIP,
                isMobile: /Mobi|Android/i.test(navigator.userAgent),
                path: window.location.pathname,
                securityLabel: 'BENIGNO_VISITA' 
            };
            
            // Colección privada: artifacts/{appId}/users/{userId}/visitor_logs
            const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
            const logCollectionPath = `artifacts/${appId}/users/${userId}/visitor_logs`;

            try {
                await addDoc(collection(db, logCollectionPath), logData);
            } catch (e) {
                console.error("Error al añadir el documento de log a Firestore:", e);
            }
        }

        /**
         * Configura el listener de tiempo real (onSnapshot) para mostrar los logs.
         * IMPORTANTE: Se elimina 'orderBy' de la query de Firestore para evitar errores de índice.
         * El ordenamiento se realiza en el cliente (client-side sorting).
         */
        function setupLogsListener(appId, currentUserId) {
            if (!db) return;

            const logCollectionPath = `artifacts/${appId}/users/${currentUserId}/visitor_logs`;
            const logsRef = collection(db, logCollectionPath);
            
            // Consulta: obtener los últimos 10 logs. SIN orderBy
            const q = query(logsRef, limit(10));

            onSnapshot(q, (snapshot) => {
                logPanel.innerHTML = ''; // Limpiar panel
                if (snapshot.empty) {
                    logPanel.innerHTML = '<p class="text-gray-500 text-center">Aún no hay logs de visitantes.</p>';
                    return;
                }

                // 1. Recoger y mapear los datos
                const logs = snapshot.docs.map(doc => doc.data());

                // 2. Ordenar los logs por timestamp (descendente) en el cliente
                logs.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));

                // 3. Renderizar los logs ordenados
                logs.forEach((data) => {
                    const date = new Date(data.timestamp).toLocaleTimeString('es-ES');
                    
                    let labelColor = 'text-green-400'; 
                    if (data.publicIP === 'Simulada' || data.publicIP.startsWith('192.168')) { 
                        labelColor = 'text-yellow-500 font-bold';
                    }
                    // Usa text-neon si es tu propia visita
                    const isSelf = logs.indexOf(data) === 0; // La primera entrada ordenada es probablemente la tuya.
                    if (isSelf) {
                        labelColor = 'text-neon font-bold';
                    }

                    const logEntry = `
                        <div class="border-b border-gray-700 pb-2">
                            <p class="text-sm font-bold ${labelColor}">
                                ${data.securityLabel} 
                                ${isSelf ? '(Tu Visita)' : '(Visitante)'}
                                <span class="text-gray-500 font-normal">(${date})</span>
                            </p>
                            <p class="text-xs text-gray-400">IP: <span class="text-neon">${data.publicIP}</span> | Res: ${data.screenResolution}</p>
                            <p class="text-xs text-gray-500 truncate">UA: ${data.userAgent}</p>
                            <p class="text-xs text-gray-500">Referencia: ${data.referrer}</p>
                        </div>
                    `;
                    logPanel.innerHTML += logEntry;
                });
                lucide.createIcons(); // Vuelve a renderizar íconos
            }, (error) => {
                console.error("Error en el listener de logs:", error);
                logPanel.innerHTML = `<p class="text-red-500 text-center">Error al cargar datos en tiempo real.</p>`;
            });
        }

        /**
         * Función genérica para manejar reintentos con backoff exponencial.
         */
        async function fetchWithRetry(url, maxRetries = 3) {
            for (let i = 0; i < maxRetries; i++) {
                try {
                    return await fetch(url);
                } catch (error) {
                    if (i < maxRetries - 1) {
                        const delay = Math.pow(2, i) * 1000;
                        await new Promise(resolve => setTimeout(resolve, delay));
                    } else {
                        throw error; // Re-lanza el error después del último reintento fallido
                    }
                }
            }
        }

        /**
         * Copia el vector de datos al portapapeles.
         */
        function copyVector(element) {
            const vector = element.getAttribute('data-vector');
            if (vector) {
                // Usar document.execCommand('copy') por restricciones de iframe
                const tempInput = document.createElement('textarea');
                tempInput.value = vector;
                document.body.appendChild(tempInput);
                tempInput.select();
                document.execCommand('copy');
                document.body.removeChild(tempInput);

                // Feedback visual
                element.style.boxShadow = `0 0 10px var(--color-primary)`;
                setTimeout(() => {
                    element.style.boxShadow = 'none';
                }, 500);
            }
        }
        
        // Exponer la función de copia globalmente
        window.copyVector = copyVector;

        // Iniciar el proceso al cargar la página
        window.onload = initFirebaseAndLogVisitor;

    </script>
</body>
</html>
